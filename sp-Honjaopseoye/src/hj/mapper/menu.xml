<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mybatis.mapper.gubunMapper">

	<select id="nSelect" parameterType="map" resultType="map">
		select
		noti_no,noti_title,noti_writer,noti_hit,noti_date
		from notice
	</select>
	<select id="qSelect" parameterType="map" resultType="map">
		select qna_title,qna_writer,qna_date,qna_depth,qna_step,qna_group
		from qna
	</select>
	<select id="qInsert" parameterType="map" resultType="map">
		insert into qna(qna_no,qna_title,qna_category,qna_pw,qna_writer,qna_hit,qna_date,qna_step,qna_depth,qna_group)
		values (seq_qna_no,#{qna_title},#{qna_category},#{qna_pw},#{mem_id},0,to_char(sysdate,"YYYY-MM-DD"),0,#{qna_depth},#{qna_group})
	</select>
	<update id="qhit" parameterType="int">
		update qna
		set qna_hit = qna_hit + 1
		where qna_no =:x
	</update>
	<select id="getGroup" parameterType="map" resultType="int">
		SELECT
        NVL((SELECT /*index_desc(qna 인덱스 부여 qna_group*/ qna_group
        FROM qna
        WHERE rownum = 1
        AND qna_group > 0),0)+1 qna_group
        FROM dual
	</select>
	<update id="qStep" parameterType="map">
		update qna
        set qna_step = qna_step+1
        where qna_group = #{qna_group} 
        and qna_step > #{qna_step} 
	</update>
</mapper>

